
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WB Mobile Store</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#5080BE">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

    <style>
        :root {
            --primary-bg: #E0F2FC;
            --brand-color: #5080BE;
            --white-soft: #E6F5FA;
        }

        body {
            background-color: var(--primary-bg);
            font-family: 'Segoe UI', sans-serif;
            padding-bottom: 80px;
            overflow-x: hidden;
        }

        /* Navbar */
        .navbar-custom {
            background-color: var(--brand-color);
            color: white;
            padding: 10px 15px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        /* Banner Carousel */
        .carousel-item img {
            height: 180px;
            object-fit: cover;
            width: 100%;
            border-radius: 8px;
        }
        .carousel-container {
            padding: 10px;
        }

        /* Categories */
        .category-scroll {
            display: flex;
            overflow-x: auto;
            padding: 10px;
            gap: 15px;
            background: white;
            white-space: nowrap;
        }
        .category-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
            cursor: pointer;
        }
        .cat-icon {
            width: 50px;
            height: 50px;
            background: #C6DEF6;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--brand-color);
            font-size: 1.2rem;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-weight: bold;
        }

        /* Products */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
        }
        .product-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: relative;
        }
        .p-img-container {
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }
        .p-img { max-height: 100%; max-width: 100%; }
        .out-of-stock-overlay {
            position: absolute; top:0; left:0; right:0; bottom:0;
            background: rgba(255,255,255,0.7);
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; color: red; font-size: 1.2rem;
            z-index: 10;
        }

        /* Admin Styles */
        .admin-badge { background: #ffcccc; color: #cc0000; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; }

        /* Auth Modal */
        .auth-modal {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); z-index: 2000;
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed; bottom: 0; width: 100%;
            background: white; display: flex; justify-content: space-around;
            padding: 12px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .nav-item.active { color: var(--brand-color); font-weight: bold; }
        .nav-item { color: #999; text-decoration: none; text-align: center; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div id="app-loader" style="position:fixed; top:0; left:0; width:100%; height:100%; bg:white; z-index:9999; display:flex; justify-content:center; align-items:center; background:white;">
        <div class="spinner-border text-primary"></div>
    </div>

    <div id="auth-modal" class="auth-modal" style="display: none;">
        <div class="bg-white p-4 rounded shadow w-90" style="max-width:350px;">
            <h4 id="auth-title">Login</h4>
            <form id="auth-form">
                <input type="email" id="auth-email" class="form-control mb-2" placeholder="Email" required>
                <input type="password" id="auth-pass" class="form-control mb-2" placeholder="Password" required>
                <button type="submit" class="btn btn-primary w-100" id="auth-submit-btn">Login</button>
            </form>
            <div class="text-center mt-3">
                <button class="btn btn-link" onclick="toggleAuthMode()">Switch to Signup / Login</button>
                <button class="btn btn-sm btn-secondary" onclick="document.getElementById('auth-modal').style.display='none'">Close</button>
            </div>
        </div>
    </div>

    <nav class="navbar-custom d-flex justify-content-between align-items-center">
        <div class="fw-bold"><i class="fas fa-mobile-alt me-2"></i>WB Store</div>
        <div>
            <i class="fas fa-user-circle fs-4" onclick="toggleProfile()"></i>
        </div>
    </nav>

    <div id="profile-menu" class="position-fixed bg-white shadow p-3 rounded" style="top:60px; right:10px; z-index:1001; display:none; width:200px;">
        <div id="user-info" class="mb-2 fw-bold small text-muted">Guest</div>
        <button id="login-btn" class="btn btn-sm btn-primary w-100 mb-2" onclick="openAuth()">Login</button>
        <button id="admin-btn" class="btn btn-sm btn-danger w-100 mb-2" style="display:none;" onclick="navTo('admin')">Admin Panel</button>
        <button id="logout-btn" class="btn btn-sm btn-outline-danger w-100" style="display:none;" onclick="handleLogout()">Logout</button>
    </div>

    <div class="p-2 bg-white sticky-top shadow-sm" style="top:55px; z-index:990;">
        <div class="input-group">
            <span class="input-group-text bg-white border-end-0"><i class="fas fa-search"></i></span>
            <input type="text" id="global-search" class="form-control border-start-0" placeholder="Search brands, mobiles...">
        </div>
    </div>

    <div id="view-home" class="view-section">
        
        <div class="carousel-container">
            <div id="bannerCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner" id="banner-wrapper">
                    <div class="carousel-item active">
                        <img src="https://via.placeholder.com/400x180?text=WB+Mobile+Store" class="d-block w-100">
                    </div>
                </div>
            </div>
        </div>

        <div class="category-scroll" id="category-list">
            </div>

        <div class="d-flex justify-content-between px-3 mt-2">
            <h6 class="fw-bold">Latest Mobiles</h6>
            <small class="text-primary" onclick="renderProducts(allProducts)">Show All</small>
        </div>
        <div id="product-list" class="product-grid">
            <p class="text-center w-100 mt-4">Loading products...</p>
        </div>
    </div>

    <div id="view-details" class="view-section p-3 bg-white d-none" style="min-height:100vh;">
        <button class="btn btn-link p-0 mb-2" onclick="navTo('home')"><i class="fas fa-arrow-left"></i> Back</button>
        <div id="detail-content"></div>
    </div>

    <div id="view-cart" class="view-section p-3 d-none">
        <h4>Your Cart</h4>
        <div id="cart-list" class="mt-3"></div>
        <div id="cart-total-box" class="card p-3 mt-3 shadow-sm d-none">
            <div class="d-flex justify-content-between fw-bold">
                <span>Total:</span>
                <span id="cart-total-val">₹0</span>
            </div>
            <button class="btn btn-success w-100 mt-2" onclick="placeOrder()">Checkout (COD)</button>
        </div>
    </div>

    <div id="view-admin" class="view-section p-3 d-none">
        <h4 class="text-danger mb-3">Admin Panel</h4>
        
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item"><button class="nav-link active" onclick="setAdminTab('add')">Add Product</button></li>
            <li class="nav-item"><button class="nav-link" onclick="setAdminTab('manage')">Manage Items</button></li>
            <li class="nav-item"><button class="nav-link" onclick="setAdminTab('banners')">Banners</button></li>
        </ul>

        <div id="adm-add" class="admin-tab">
            <form onsubmit="adminUploadProduct(event)">
                <input type="text" id="p-name" class="form-control mb-2" placeholder="Product Name" required>
                <input type="text" id="p-brand" class="form-control mb-2" placeholder="Brand (e.g. Oppo, Vivo, Apple)" required>
                <textarea id="p-desc" class="form-control mb-2" placeholder="Description"></textarea>
                <div class="row g-2">
                    <div class="col"><input type="number" id="p-price" class="form-control mb-2" placeholder="Price" required></div>
                    <div class="col"><input type="number" id="p-stock" class="form-control mb-2" placeholder="Stock Qty" required></div>
                </div>
                <input type="file" id="p-file" class="form-control mb-3" required>
                <button type="submit" class="btn btn-primary w-100" id="upload-btn">Upload Product</button>
            </form>
        </div>

        <div id="adm-manage" class="admin-tab d-none">
            <h6 class="text-muted">All Products</h6>
            <div id="admin-product-list"></div>
        </div>

        <div id="adm-banners" class="admin-tab d-none">
            <h6>Upload New Banner</h6>
            <div class="d-flex gap-2 mb-3">
                <input type="file" id="banner-file" class="form-control">
                <button class="btn btn-success" onclick="uploadBanner()">Upload</button>
            </div>
            <h6>Active Banners</h6>
            <div id="admin-banner-list"></div>
        </div>
    </div>

    <div class="bottom-nav">
        <a href="#" class="nav-item active" onclick="navTo('home')"><i class="fas fa-home fs-5"></i><br>Home</a>
        <a href="#" class="nav-item" onclick="navTo('cart')">
            <div class="position-relative">
                <i class="fas fa-shopping-cart fs-5"></i>
                <span id="cart-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display:none; font-size:0.6rem;">0</span>
            </div>
            Cart
        </a>
        <a href="#" class="nav-item" onclick="toggleProfile()"><i class="fas fa-user fs-5"></i><br>Profile</a>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        // CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyBx724MefpWjw6KfUMX9o7BkygQ5xeD02k",
            authDomain: "wb-mobile-store.firebaseapp.com",
            projectId: "wb-mobile-store",
            storageBucket: "wb-mobile-store.firebasestorage.app",
            messagingSenderId: "54481231902",
            appId: "1:54481231902:web:395ad38266e975fae6ce0f"
        };
        const ADMIN_EMAIL = "wbstore.india@gmail.com";
        const CLOUD_URL = "https://api.cloudinary.com/v1_1/dyt6fwvw0/image/upload";
        const CLOUD_PRESET = "Wb_mobile_products";

        // INIT
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let allProducts = [];
        let cart = JSON.parse(localStorage.getItem('wb_cart')) || [];
        let currentUser = null;

        // --- APP START ---
        window.addEventListener('DOMContentLoaded', () => {
            loadProducts();
            loadBanners();
            updateCartUI();
        });

        auth.onAuthStateChanged(user => {
            currentUser = user;
            document.getElementById('app-loader').style.display = 'none';
            
            const profileMenu = document.getElementById('user-info');
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const adminBtn = document.getElementById('admin-btn');

            if (user) {
                profileMenu.textContent = user.email;
                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
                if (user.email === ADMIN_EMAIL) adminBtn.style.display = 'block';
            } else {
                profileMenu.textContent = "Guest";
                loginBtn.style.display = 'block';
                logoutBtn.style.display = 'none';
                adminBtn.style.display = 'none';
            }
        });

        // --- DATA LOADING & DYNAMIC UI ---

        // 1. Fetch Products & Build Categories
        async function loadProducts() {
            try {
                // If index is building, this might throw error, handled in catch
                const snap = await db.collection('products').orderBy('createdAt', 'desc').get();
                allProducts = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Render Products
                renderProducts(allProducts);
                
                // Build Categories Dynamically
                const uniqueBrands = [...new Set(allProducts.map(p => p.brand))].sort();
                renderCategories(uniqueBrands);

            } catch (error) {
                console.log("Index issue or network:", error);
                document.getElementById('product-list').innerHTML = `<div class="alert alert-warning">System optimizing... Products will appear shortly.</div>`;
            }
        }

        // 2. Render Products
        function renderProducts(list) {
            const container = document.getElementById('product-list');
            container.innerHTML = "";
            
            list.forEach(p => {
                const isOutOfStock = parseInt(p.stock) <= 0;
                container.innerHTML += `
                <div class="product-card" onclick="openDetails('${p.id}')">
                    ${isOutOfStock ? '<div class="out-of-stock-overlay">OUT OF STOCK</div>' : ''}
                    <div class="p-img-container">
                        <img src="${p.image}" class="p-img" loading="lazy">
                    </div>
                    <div class="p-2">
                        <small class="text-muted text-uppercase fw-bold">${p.brand}</small>
                        <div class="fw-bold text-truncate">${p.name}</div>
                        <div class="d-flex justify-content-between align-items-center mt-1">
                            <span class="fw-bold">₹${p.price}</span>
                            ${isOutOfStock ? '' : '<i class="fas fa-plus-circle text-primary fs-4"></i>'}
                        </div>
                    </div>
                </div>`;
            });
        }

        // 3. Render Dynamic Categories
        function renderCategories(brands) {
            const container = document.getElementById('category-list');
            // Always keep 'All'
            let html = `
            <div class="category-item" onclick="renderProducts(allProducts)">
                <div class="cat-icon"><i class="fas fa-th-large"></i></div>
                <small>All</small>
            </div>`;

            brands.forEach(brand => {
                // Create circle for each brand found
                const firstLetter = brand.charAt(0).toUpperCase();
                html += `
                <div class="category-item" onclick="filterByBrand('${brand}')">
                    <div class="cat-icon">${firstLetter}</div>
                    <small>${brand}</small>
                </div>`;
            });
            container.innerHTML = html;
        }

        function filterByBrand(brand) {
            const filtered = allProducts.filter(p => p.brand === brand);
            renderProducts(filtered);
        }

        // 4. Banners Logic (Persistent)
        async function loadBanners() {
            const wrapper = document.getElementById('banner-wrapper');
            const snap = await db.collection('banners').orderBy('createdAt', 'desc').get();
            
            if(!snap.empty) {
                wrapper.innerHTML = "";
                let active = "active";
                snap.forEach(doc => {
                    const data = doc.data();
                    wrapper.innerHTML += `
                    <div class="carousel-item ${active}">
                        <img src="${data.url}" class="d-block w-100">
                    </div>`;
                    active = "";
                });
            }
        }

        // --- SEARCH ---
        document.getElementById('global-search').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const res = allProducts.filter(p => 
                p.name.toLowerCase().includes(term) || p.brand.toLowerCase().includes(term)
            );
            renderProducts(res);
        });

        // --- ADMIN FUNCTIONS ---

        // Tab Switching
        window.setAdminTab = (tab) => {
            document.querySelectorAll('.admin-tab').forEach(el => el.classList.add('d-none'));
            document.getElementById(`adm-${tab}`).classList.remove('d-none');
            
            if(tab === 'manage') loadAdminManageList();
            if(tab === 'banners') loadAdminBannerList();
        }

        // Upload Product
        async function adminUploadProduct(e) {
            e.preventDefault();
            const btn = document.getElementById('upload-btn');
            btn.disabled = true; btn.innerText = "Uploading...";

            try {
                const file = document.getElementById('p-file').files[0];
                const imgUrl = await uploadToCloudinary(file);
                
                await db.collection('products').add({
                    name: document.getElementById('p-name').value,
                    brand: document.getElementById('p-brand').value, // Dynamic Brand
                    description: document.getElementById('p-desc').value,
                    price: Number(document.getElementById('p-price').value),
                    stock: Number(document.getElementById('p-stock').value), // Stock
                    image: imgUrl,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                Toastify({text: "Product Added!", style: {background: "green"}}).showToast();
                e.target.reset();
                loadProducts(); // Refresh list

            } catch(err) { alert(err.message); }
            btn.disabled = false; btn.innerText = "Upload Product";
        }

        // Manage Products (Delete)
        function loadAdminManageList() {
            const list = document.getElementById('admin-product-list');
            list.innerHTML = "";
            allProducts.forEach(p => {
                list.innerHTML += `
                <div class="d-flex justify-content-between align-items-center border-bottom p-2">
                    <div class="d-flex align-items-center gap-2">
                        <img src="${p.image}" width="40">
                        <div>
                            <div class="fw-bold small">${p.name}</div>
                            <div class="text-muted small">Stock: ${p.stock}</div>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteProduct('${p.id}')">Delete</button>
                </div>`;
            });
        }

        async function deleteProduct(id) {
            if(!confirm("Delete this product?")) return;
            await db.collection('products').doc(id).delete();
            // Refresh
            allProducts = allProducts.filter(p => p.id !== id);
            loadAdminManageList();
            loadProducts();
            Toastify({text: "Deleted", style: {background: "red"}}).showToast();
        }

        // Banner Management
        async function uploadBanner() {
            const file = document.getElementById('banner-file').files[0];
            if(!file) return alert("Choose file");
            
            const url = await uploadToCloudinary(file);
            await db.collection('banners').add({
                url: url,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            Toastify({text: "Banner Added", style: {background: "green"}}).showToast();
            loadBanners();
            loadAdminBannerList();
        }

        async function loadAdminBannerList() {
            const div = document.getElementById('admin-banner-list');
            const snap = await db.collection('banners').get();
            div.innerHTML = "";
            snap.forEach(doc => {
                div.innerHTML += `
                <div class="d-flex justify-content-between align-items-center p-2 border mb-1">
                    <img src="${doc.data().url}" height="50">
                    <button class="btn btn-sm btn-danger" onclick="deleteBanner('${doc.id}')"><i class="fas fa-trash"></i></button>
                </div>`;
            });
        }
        
        async function deleteBanner(id) {
            await db.collection('banners').doc(id).delete();
            loadAdminBannerList();
            loadBanners();
        }

        // --- CART & ORDERS ---
        
        function openDetails(id) {
            const p = allProducts.find(x => x.id === id);
            const isOutOfStock = p.stock <= 0;
            
            document.getElementById('view-home').classList.add('d-none');
            const view = document.getElementById('view-details');
            view.classList.remove('d-none');
            
            document.getElementById('detail-content').innerHTML = `
                <div class="text-center bg-white rounded p-3 mb-3">
                    <img src="${p.image}" style="max-height:300px; max-width:100%;">
                </div>
                <div class="badge bg-secondary mb-2">${p.brand}</div>
                <h3>${p.name}</h3>
                <h2 class="text-primary fw-bold">₹${p.price}</h2>
                <p class="text-muted">${p.description || ''}</p>
                <div class="mt-4">
                    <p class="mb-1 fw-bold ${isOutOfStock ? 'text-danger':'text-success'}">
                        ${isOutOfStock ? 'Out of Stock' : `In Stock: ${p.stock}`}
                    </p>
                    <button class="btn btn-lg w-100 ${isOutOfStock ? 'btn-secondary' : 'btn-brand'}" 
                        onclick="addToCart('${p.id}')" ${isOutOfStock ? 'disabled' : ''}>
                        ${isOutOfStock ? 'Unavailable' : 'Add to Cart'}
                    </button>
                </div>
            `;
        }

        function addToCart(id) {
            const p = allProducts.find(x => x.id === id);
            const existing = cart.find(x => x.id === id);
            
            if(existing) {
                if(existing.qty >= p.stock) return alert("Max stock reached!");
                existing.qty++;
            } else {
                cart.push({...p, qty: 1});
            }
            saveCart();
            Toastify({text: "Added to Cart"}).showToast();
        }

        function updateCartUI() {
            document.getElementById('cart-badge').innerText = cart.reduce((a,b)=>a+b.qty,0);
            document.getElementById('cart-badge').style.display = cart.length ? 'block' : 'none';
            
            const list = document.getElementById('cart-list');
            if(list) {
                list.innerHTML = "";
                let total = 0;
                cart.forEach(item => {
                    total += item.price * item.qty;
                    list.innerHTML += `
                    <div class="d-flex justify-content-between align-items-center bg-white p-2 mb-2 rounded shadow-sm">
                        <div class="d-flex align-items-center gap-2">
                            <img src="${item.image}" width="50" height="50" style="object-fit:cover">
                            <div>
                                <div class="fw-bold small">${item.name}</div>
                                <div class="small">₹${item.price} x ${item.qty}</div>
                            </div>
                        </div>
                        <i class="fas fa-trash text-danger" onclick="removeFromCart('${item.id}')"></i>
                    </div>`;
                });
                
                document.getElementById('cart-total-val').innerText = "₹" + total;
                document.getElementById('cart-total-box').classList.toggle('d-none', cart.length === 0);
            }
        }

        function removeFromCart(id) {
            cart = cart.filter(x => x.id !== id);
            saveCart();
        }

        function saveCart() {
            localStorage.setItem('wb_cart', JSON.stringify(cart));
            updateCartUI();
        }

        async function placeOrder() {
            if(!currentUser) { openAuth(); return; }
            if(!confirm("Confirm Order (Cash on Delivery)?")) return;

            const total = cart.reduce((a,b)=>a+(b.price*b.qty),0);
            
            await db.collection('orders').add({
                userId: currentUser.uid,
                userEmail: currentUser.email,
                items: cart,
                total: total,
                status: "Pending",
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });

            // Optional: Reduce stock in DB here (requires detailed logic)
            
            cart = []; saveCart();
            Toastify({text: "Order Placed!", style: {background: "green"}}).showToast();
            navTo('home');
        }

        // --- UTILS ---
        async function uploadToCloudinary(file) {
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', CLOUD_PRESET);
            const res = await fetch(CLOUD_URL, { method: 'POST', body: formData });
            const data = await res.json();
            return data.secure_url;
        }

        function navTo(view) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('d-none'));
            document.getElementById(`view-${view}`).classList.remove('d-none');
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            // Highlight nav
            if(view === 'home') document.querySelectorAll('.nav-item')[0].classList.add('active');
            if(view === 'cart') {
                document.querySelectorAll('.nav-item')[1].classList.add('active');
                updateCartUI();
            }
            if(view === 'admin') setAdminTab('add');
        }

        // Auth
        let isLogin = true;
        function toggleAuthMode() {
            isLogin = !isLogin;
            document.getElementById('auth-title').innerText = isLogin ? "Login" : "Signup";
            document.getElementById('auth-submit-btn').innerText = isLogin ? "Login" : "Signup";
        }
        function openAuth() { document.getElementById('auth-modal').style.display = 'flex'; }
        function toggleProfile() { 
            const m = document.getElementById('profile-menu');
            m.style.display = m.style.display==='none'?'block':'none';
        }

        document.getElementById('auth-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const em = document.getElementById('auth-email').value;
            const pw = document.getElementById('auth-pass').value;
            try {
                if(isLogin) await auth.signInWithEmailAndPassword(em, pw);
                else await auth.createUserWithEmailAndPassword(em, pw);
                document.getElementById('auth-modal').style.display = 'none';
                Toastify({text: "Success!"}).showToast();
            } catch(e) { alert(e.message); }
        });
        function handleLogout() { auth.signOut(); navTo('home'); }

    </script>
</body>
</html>


